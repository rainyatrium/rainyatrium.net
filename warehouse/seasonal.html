<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>fancymenu seasonal logic test</title>
        <style>
        </style>
            <script 
    src="https://code.jquery.com/jquery-3.7.1.min.js"
  	integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
  	crossorigin="anonymous">
    </script>

    </head>
        <!-- testing logic for fancymenu so this code is arranged a bit oddly-->
    
    <button type="button" id="resetButton"> reset </button>
    <form>
    <b>Month</b>
    <input id="monthInput" type="text" label = "month">
    <b>Day</b>
    <input id="dayInput"  type="text" label = "day">
    <br>
    <span id="dayMonth"></span>
    <br>
    <span id="seasonSpan"> </span>
    <br>
    <span id="currentEventSpan"></span>
    </form>
    <script>
    
    let eventSetupStage = 0;
    let month;
    let currentEvent;
    let day;
    let eventCount = -1;
    let eventTotal;
    let events; 
    let withinMonthBounds;
    $.get('/warehouse/events.json', function(data){
        events = data[Object.keys(data)[0]]
        eventTotal = events.length;
        eventSetupStage = 1;
      });
   
    setInterval(function(){

      if (eventSetupStage == 1) {
        //this is our stupid knockoff for loop because we don't have for loops in fancymenu.. or a less than
        //the array runs with 0-4 even though arraylength gives us 5 because fuck you
        if (eventCount <= eventTotal-2) {  
        eventCount = eventCount + 1
        } else {
        eventSetupStage = 2 }
        console.log('=== RUNNING FOR ' + eventCount + ' ===');
        //now check if we are within day/month bounds
        //if (month > eventCount.monthStart
        examinedEvent = events[eventCount];
        if ((month >= examinedEvent.monthStart) && (month <= examinedEvent.monthEnd)) { //withinmonthbounds
          console.log('within month bounds!');
          withinMonthBounds = true;
          //okay, we know we are within the month bounds, so let's get more specific. in a hell world kind of way.
          if (examinedEvent.monthStart == examinedEvent.monthEnd) { //if we are in the same month, let's check days w/ more specificity
            console.log('this event starts and ends within the same month...');
            shortEvent = true;
            if ((day >= examinedEvent.dayStart) && (day <= examinedEvent.dayEnd)) { //withindaybounds
              console.log('and we are currently within that period! cool!')
              currentEvent = examinedEvent.name;
              }
          } else if ((month == examinedEvent.monthStart) && (day >= examinedEvent.dayStart)) { //startingmonthandafterstart (if we are at the start & past the starting day)
              console.log("we're in the starting month and after the starting day!")
              currentEvent = examinedEvent.name;
          } else if ((month == examinedEvent.monthEnd) && (day <= examinedEvent.dayEnd)) { //endingmonthandbeforeend (if we are at the end & before the ending day)
              console.log("we're in the ending month and before the ending day!")
              currentEvent = examinedEvent.name;
          } //i originally had a check that we were within inner months, but i think it should be fine because it gets covered by default? so let's try without
          else { 
            console.log("we should be in the inner months at the moment");
            currentEvent = examinedEvent.name; }
        }
      }
  
      
      document.getElementById("dayMonth").innerHTML= 'month:' + month + ' day:' + day; //month/day
      document.getElementById("seasonSpan").innerHTML= '<b>season:' + currentEvent + '</b> | withinMonthBounds:'+withinMonthBounds + ' |eventCount:' + eventCount; //seasn
      document.getElementById("currentEventSpan").innerHTML=JSON.stringify(events[eventCount]); //current json
      month = document.getElementById("monthInput").value;
      day = document.getElementById("dayInput").value; 
    }, 100);
    
    document.getElementById("resetButton").addEventListener("click", function () {
      eventSetupStage = 1;
      eventCount = -1;
    });
    </script>
    
    </body>
    

</html>